# Q-Learning 交通模擬控制器 - 使用說明

本模擬控制器允許您使用經過 Q-Learning 訓練的智能體來模擬城市交通情境，可以暫停並隨時調整模擬步數。

## 程式執行方式

有三種執行模式：

1. **訓練模式** - 訓練一個新的 Q-Learning 代理
```bash
python main.py --mode train [--episodes 數量] [--no-plots] [--no-save]
```

2. **模擬模式** - 使用已訓練的代理進行交互式模擬
```bash
python main.py --mode simulate
```

3. **兩者皆執行** - 先訓練後模擬 (預設)
```bash
python main.py 
# 或 python main.py --mode both
```

## 命令行參數

- `--mode {train,simulate,both}`: 選擇執行模式
- `--episodes N`: 設定訓練回合數 (預設: 200)
- `--no-plots`: 訓練過程中不顯示圖表
- `--no-save`: 不儲存訓練結果

## 模擬控制器功能

模擬控制器提供以下功能：

### 基本控制
- **開始** - 開始或繼續模擬
- **暫停** - 暫停當前模擬
- **單步執行** - 執行單一模擬步驟
- **重置** - 重置模擬到初始狀態

### 參數調整
- **步驟延遲** - 控制模擬速度 (50毫秒至2000毫秒)
- **最大步數** - 設定模擬的最大步數 (10至500步)
- **車輛數量** - 調整模擬中的車輛數量 (1至20輛)

### 環境控制
- **添加隨機障礙** - 在地圖上生成隨機障礙和交通事故

### 代理管理
- **載入代理** - 從檔案載入訓練好的Q-Learning代理
- **保存代理** - 將當前代理儲存至檔案

## 使用流程

1. 首先執行訓練模式以獲得訓練好的代理:
   ```bash
   python main.py --mode train --episodes 200
   ```

2. 之後可以隨時使用模擬模式來運行交互式模擬:
   ```bash
   python main.py --mode simulate
   ```

3. 在模擬控制器中:
   - 調整車輛數量
   - 點擊 "開始" 啟動模擬
   - 使用 "暫停/繼續" 暫停或繼續模擬
   - 使用 "單步執行" 一次前進一步
   - 調整延遲滑塊來控制模擬速度

## 狀態顯示

- **步驟計數器** - 顯示當前模擬步數
- **完成狀態** - 顯示已到達目的地的車輛數量
- **狀態訊息** - 提供關於模擬狀態的詳細信息

## 技術細節

本模擬使用：
- Q-Learning 學習算法進行路徑規劃
- 考慮交通擁堵和交通信號燈
- 支援隨機障礙和交通事故模擬
- 車輛會根據Q-Learning自行規劃避開擁堵和障礙的路線
